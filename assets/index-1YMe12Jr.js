var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:1,configurable:1,writable:1,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);function i(t){return t[Math.floor(Math.random()*t.length)]}!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:1,subtree:1})}function e(t){if(t.ep)return;t.ep=1;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class s{constructor(t=1/0){e(this,"array"),e(this,"maxLength"),this.array=[],this.maxLength=t}*[Symbol.iterator](){for(let t=0;t<this.array.length;t++)yield this.array[t]}add(t){this.array.includes(t)||this.array.length===this.maxLength||this.array.push(t)}remove(t){const e=this.array.indexOf(t);-1!==e&&this.array.splice(e,1)}get(t){return this.array[t]}has(t){return this.array.includes(t)}random(){return i(this.array)}indexOf(t){return this.array.indexOf(t)}clear(){this.array.splice(0,this.size)}get size(){return this.array.length}}class r{constructor(t,i){e(this,"width"),e(this,"height"),e(this,"tiles"),this.tiles=[],this.width=t%2==0?t+1:t,this.height=i%2==0?i+1:i}create(){this.tiles.splice(0,this.tiles.length);for(let t=0;t<this.width;t++)for(let e=0;e<this.height;e++)this.tiles.push({x:e,y:t,isWall:1});const t=this.getTile(1,1),e=new s,r=new Set;for(t.isWall=0,r.add(this.getTileIndex(t)),e.add(this.getTile(3,1)),e.add(this.getTile(1,3));e.size>0;){const t=e.random(),s=this.getNeighbours(t,2),h=i(s.filter(t=>r.has(this.getTileIndex(t.tile)))),n=this.getTile(t.x+h.direction[0],t.y+h.direction[1]);r.add(this.getTileIndex(t)),n.isWall=0,t.isWall=0,e.remove(t);for(const t of s)t.tile&&!r.has(this.getTileIndex(t.tile))&&e.add(t.tile)}}getTile(t,e){return this.tiles[this.getTileIndex(t,e)]}getTileIndex(t,e){return"number"!=typeof t&&(e=t.y,t=t.x),t+this.height*e}getNeighbours(t,e=1){return[[1,0],[0,1],[-1,0],[0,-1]].map(i=>({tile:this.getTile(t.x+i[0]*e,t.y+i[1]*e),direction:i})).filter(t=>t.tile&&t.tile.x>0&&t.tile.y>0&&t.tile.x<this.width-1&&t.tile.y<this.height-1)}*[Symbol.iterator](){yield*this.tiles}}class h{constructor(t=0,i=0){e(this,"x"),e(this,"y"),this.x=t,this.y=i}}class n{constructor(t){e(this,"maze"),e(this,"position"),this.maze=t,this.position=new h(1,1)}}e(n,"SIZE",.5);const a=document.getElementById("main"),l=new r(30,30);l.create();const o=new n(l);new class{constructor(t,i,s){e(this,"maze"),e(this,"player"),e(this,"canvas"),e(this,"ctx"),this.maze=i,this.player=s,this.canvas=t;const r=t.getContext("2d");if(null===r)throw Error("Could not get 2D Canvas Rendering Context");this.ctx=r,new ResizeObserver(t=>{const e=t[0].devicePixelContentBoxSize[0];this.canvas.width=e.inlineSize,this.canvas.height=e.blockSize,this.render()}).observe(t)}render(){this.ctx.fillStyle="#333",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.renderMaze(),this.renderPlayer()}renderMaze(){const t=this.getTileSize(),e=this.getMazeCorner();for(const i of this.maze){const s=t*i.x+e.x,r=t*i.y+e.y;this.ctx.fillStyle=i.isWall?"#000":"#fff",this.ctx.fillRect(s,r,t,t)}}renderPlayer(){const t=this.getTileSize(),e=n.SIZE*t,i=this.getMazeCorner(),s=i.x+this.player.position.x*t+.5*(t-e),r=i.y+(this.maze.height-this.player.position.y-1)*t+.5*(t-e);this.ctx.fillStyle="#f00",this.ctx.fillRect(s,r,e,e)}getTileSize(){return Math.floor(.95*Math.min(this.canvas.width/this.maze.width,this.canvas.height/this.maze.height))}getMazeCorner(){const t=this.getTileSize();return new h((this.canvas.width-t*this.maze.width)/2,(this.canvas.height-t*this.maze.height)/2)}}(a,l,o).render();